{% extends "base.html" %}
{% block content %}
<div id="modal" class="modal">
    <div class="modal-content">
        <h2>Nowy koncert</h2>
        <form id="addForm" novalidate>
            <input type="hidden" id="id" name="id">
            
            <label>Nazwa u≈ºytkownika:</label>
            <input type="text" id="nazwa" name="nazwa" required placeholder="Wpisz nazwƒô...">
            
            <label>Has≈Ço (zostaw puste, aby nie zmieniaƒá):</label>
            <input type="password" id="haslo" name="haslo" placeholder="Wpisz nowe has≈Ço...">
            
            <label>Rola:</label>
            <select id="rola" name="rola">
                <option value="user">USER</option>
                <option value="admin">ADMIN</option>
            </select>

            <div class="modal-controls">
                <button type="submit" class="save-btn">Zapisz</button>
                <button type="button" onclick="closeModal()" class="cancel-btn">Anuluj</button>
            </div>
        </form>
    </div>
</div>

<div class="container">
    <div class="report-tabs">
        <button class="tab-btn active" onclick="showReport('users')">üë• U≈ºytkownicy</button>
        <button class="tab-btn" onclick="showReport('occupancy')">üé∂ Koncerty</button>
        <button class="tab-btn" onclick="showReport('artists')">üé§ Arty≈õci</button>
        <button class="tab-btn" onclick="showReport('cities')">üåÉ Miasta</button>
        <button class="tab-btn" onclick="showReport('income')">üí∞ Sprzeda≈º</button>
    </div>
</div>

<div id="users" class="report-content" style="display: block;">
    <table class="report-table users">
        <tr><th colspan="3">ZarzƒÖdzanie U≈ºytkownikami</th></tr>
        {% for u in uzytkownicy %}
            <tr>
                <td style="width: 40px;"><strong style="color: #ffdd1c;">{% if u.rola == 'admin' %} üú≤ {%endif%}</strong></td>
                <td>{{ u.nazwa }}</td>
                <td>
                    <div class="controls" style="justify-content: flex-end;">
                        <button class="btn-edit" onclick="event.stopPropagation(); openEditModal('uzytkownicy', '{{ u.id }}')">‚úé</button>
                        {% if u.id != session.user_id %}
                            <button class="btn-delete" onclick="event.stopPropagation(); deleteItem('uzytkownicy', '{{ u.id }}')">‚úñ</button>
                        {% endif %}
                    </div>
                </td>
            </tr>
        {% endfor %}
    </table>
</div>

<div id="occupancy" class="report-content" style="display: none;">
    <h2>Analiza frekwencji na poszczeg√≥lnych wydarzeniach.</h2>
    <table class="report-table">
        <thead><tr><th>Koncert</th><th>Artysta</th><th>Miejsce</th><th>Zajƒôte miejsca</th><th>%</th></tr></thead>
        <tbody>
            {% for o in oblozenie %}
            <tr><td>{{ o.koncert }}</td><td>{{ o.artysta }}</td><td>{{ o.miejsce }}</td><td>{{ o.zajete_miejsca }}/{{ o.pojemnosc }}</td><td>{{ o.procent }}%</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="artists" class="report-content" style="display: none;">
    <h2>Wyniki sprzeda≈ºowe konkretnych wykonawc√≥w.</h2>
    <table class="report-table">
        <thead><tr><th>Artysta</th><th>Sprzedane bilety</th><th>Przych√≥d</th></tr></thead>
        <tbody>
            {% for a in artysci %}
            <tr><td><strong>{{ a.artysta }}</strong></td><td>{{ a.liczba_biletow }} szt.</td><td style="color: #28a745; font-weight: bold;">{{ a.kwota }} z≈Ç</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="income" class="report-content" style="display: none;">
    <h2>Trendy czasowe w sprzeda≈ºy bilet√≥w</h2>
    <table class="report-table">
        <thead><tr><th>Okres (MiesiƒÖc)</th><th>Sprzedane bilety</th><th>Ca≈Çkowity przych√≥d</th></tr></thead>
        <tbody>
            {% for s in sprzedaz %}
            <tr><td>{{ s.miesiac }}</td><td>{{ s.liczba_biletow }} szt.</td><td style="color: #28a745; font-weight: bold;">{{ s.przychod }} z≈Ç</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="cities" class="report-content" style="display: none;">
    <h2>Analiza danych pod kƒÖtem geograficznym</h2>
    <table class="report-table">
        <thead><tr><th>Miasto</th><th>Sprzedane bilety</th><th>≈örednia cena</th><th>≈ÅƒÖczny przych√≥d</th></tr></thead>
        <tbody>
            {% for m in miasta %}
            <tr><td><strong>{{ m.miasto }}</strong></td><td>{{ m.liczba_sprzedanych_biletow }} szt.</td><td>{{ m.srednia_cena_biletu }} z≈Ç</td><td style="color: #28a745; font-weight: bold;">{{ m.laczny_przychod }} z≈Ç</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}